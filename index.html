<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ORBIT Paddle</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
  --orbit-primary:#00f2ff;
  --orbit-secondary:#7000ff;
  --orbit-bg:#0a0b10;
  --orbit-card:#161b22;
  --text:#ffffff;
}
body{font-family:Segoe UI,Roboto,sans-serif;padding:20px;background:var(--orbit-bg);color:var(--text);max-width:700px;margin:auto;}
h1{text-align:center;color:var(--orbit-primary);letter-spacing:2px;}
h3{color:var(--orbit-secondary);border-bottom:1px solid #333;padding-bottom:5px;}
input,select,button{padding:10px;margin:6px 0;width:100%;border-radius:8px;border:1px solid #333;background:#0d1117;color:white;}
button{background:linear-gradient(45deg,var(--orbit-secondary),#4b00ad);font-weight:bold;cursor:pointer;}
.btn-win{background:linear-gradient(45deg,var(--orbit-primary),#00a2ad);color:#000;}
.btn-safe{background:linear-gradient(45deg,#0066ff,#0044aa);}
.card{background:var(--orbit-card);padding:20px;border-radius:16px;margin-bottom:20px;border:1px solid #30363d;}
table{width:100%;border-collapse:collapse;}
th,td{padding:8px;border-bottom:1px solid #30363d;text-align:center;}
th{color:var(--orbit-primary);font-size:.75em;}
</style>
</head>

<body>

<h1>ORBIT Paddle</h1>

<div class="card">
<h3>üöÄ Introducir nuevo jugador</h3>
<input id="playerName" placeholder="Nombre del jugador">
<button onclick="addPlayer()">A√±adir</button>
</div>

<div class="card">
<h3>‚òÑÔ∏è Resultado del Encuentro (mejor de 3 sets)</h3>

<b>Pareja Alpha</b>
<select id="a1"></select>
<select id="a2"></select>

<b>Pareja Beta</b>
<select id="b1"></select>
<select id="b2"></select>

<h4>Sets</h4>
<div>Set 1: <input id="s1a" type="number" placeholder="Alpha"> <input id="s1b" type="number" placeholder="Beta"></div>
<div>Set 2: <input id="s2a" type="number"> <input id="s2b" type="number"></div>
<div>Set 3: <input id="s3a" type="number"> <input id="s3b" type="number"></div>

<button class="btn-win" onclick="processMatch()">Cargar Partido</button>
</div>

<div class="card">
<h3>üìä Ranking General</h3>
<table>
<thead>
<tr><th>Jugador</th><th>PJ</th><th>Pts</th></tr>
</thead>
<tbody id="rankingBody"></tbody>
</table>
</div>

<div class="card">
<h3>üìà Ranking Estad√≠sticas</h3>
<table>
<thead>
<tr>
<th>Jugador</th>
<th>Sets G</th>
<th>% Sets</th>
<th>Games G</th>
<th>% Games</th>
</tr>
</thead>
<tbody id="statsBody"></tbody>
</table>
</div>

<button class="btn-safe" onclick="resetData()">NO TOCAR</button>

<script>
let players = JSON.parse(localStorage.getItem('orbit_players')||'[]');

function save(){
localStorage.setItem('orbit_players',JSON.stringify(players));
render();
}

function addPlayer(){
const n=document.getElementById('playerName').value.trim();
if(!n||players.find(p=>p.name===n))return;
players.push({
name:n,points:0,played:0,
setsWon:0,setsPlayed:0,
gamesWon:0,gamesPlayed:0
});
document.getElementById('playerName').value='';
save();
}

function processMatch(){
const A=[a1.value,a2.value];
const B=[b1.value,b2.value];
if(new Set([...A,...B]).size!==4){alert("4 jugadores distintos");return;}

let sets=[[s1a.value,s1b.value],[s2a.value,s2b.value],[s3a.value,s3b.value]];
let setWinsA=0,setWinsB=0;

sets.forEach(s=>{
if(s[0]===''||s[1]==='')return;
let ga=parseInt(s[0]),gb=parseInt(s[1]);
players.forEach(p=>{
if(A.includes(p.name)){p.gamesWon+=ga;p.gamesPlayed+=ga+gb;}
if(B.includes(p.name)){p.gamesWon+=gb;p.gamesPlayed+=ga+gb;}
});
if(ga>gb)setWinsA++; else setWinsB++;
});

const winners=setWinsA>setWinsB?A:B;

players.forEach(p=>{
if([...A,...B].includes(p.name)){
p.played++;
p.setsPlayed+=setWinsA+setWinsB;
}
if(winners.includes(p.name)){
p.points+=3;
p.setsWon+=Math.max(setWinsA,setWinsB);
}
});

save();
}

function resetData(){
if(confirm("¬øSeguro?")){
players=[];
save();
}
}

function render(){
players.sort((a,b)=>b.points-a.points);
rankingBody.innerHTML=players.map(p=>`
<tr><td>${p.name}</td><td>${p.played}</td><td>${p.points}</td></tr>`).join('');

statsBody.innerHTML=players.map(p=>{
let ps=p.setsPlayed?((p.setsWon/p.setsPlayed)*100).toFixed(1):'0';
let pg=p.gamesPlayed?((p.gamesWon/p.gamesPlayed)*100).toFixed(1):'0';
return `<tr>
<td>${p.name}</td>
<td>${p.setsWon}</td>
<td>${ps}%</td>
<td>${p.gamesWon}</td>
<td>${pg}%</td>
</tr>`;
}).join('');

['a1','a2','b1','b2'].forEach(id=>{
document.getElementById(id).innerHTML=players.map(p=>`<option>${p.name}</option>`).join('');
});
}
render();
</script>
</body>
</html>
