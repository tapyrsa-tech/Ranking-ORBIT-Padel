<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ORBIT Paddle PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#0a0b10;color:white;font-family:Segoe UI;padding:20px;max-width:900px;margin:auto}
h1,h2{color:#00f2ff;text-align:center}
.card{background:#161b22;padding:15px;border-radius:12px;margin-bottom:20px}
input,select,button{width:100%;padding:10px;margin:6px 0;border-radius:8px;background:#0d1117;color:white;border:1px solid #333}
button{background:#00f2ff;color:black;font-weight:bold}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #333;text-align:center}
th{color:#00f2ff;font-size:0.8em}
.pct{color:#aaa}
</style>
</head>
<body>

<h1>ORBIT Paddle PRO</h1>

<div class="card">
<input id="playerName" placeholder="Nuevo jugador">
<button onclick="addPlayer()">Agregar</button>
</div>

<div class="card">
<h3>Partido</h3>
<select id="a1"></select><select id="a2"></select>
<select id="b1"></select><select id="b2"></select>
<input id="s1a" type="number" placeholder="Set1 A">
<input id="s1b" type="number" placeholder="Set1 B">
<input id="s2a" type="number" placeholder="Set2 A">
<input id="s2b" type="number" placeholder="Set2 B">
<input id="s3a" type="number" placeholder="Set3 A">
<input id="s3b" type="number" placeholder="Set3 B">
<button onclick="processMatch()">Registrar</button>
</div>

<div class="card"><h3>Ranking Puntos</h3><table><thead><tr><th>Jugador</th><th>PJ</th><th>Pts</th><th>Racha</th></tr></thead><tbody id="rankPoints"></tbody></table></div>
<div class="card"><h3>Ranking Sets</h3><table><thead><tr><th>Jugador</th><th>Gan</th><th>Tot</th><th>%</th></tr></thead><tbody id="rankSets"></tbody></table></div>
<div class="card"><h3>Ranking Games</h3><table><thead><tr><th>Jugador</th><th>Gan</th><th>Tot</th><th>%</th><th>Avg</th></tr></thead><tbody id="rankGames"></tbody></table></div>
<div class="card"><h3>Ranking Parejas</h3><table><thead><tr><th>Pareja</th><th>PJ</th><th>PG</th><th>%</th></tr></thead><tbody id="rankPairs"></tbody></table></div>

<script>
let players=JSON.parse(localStorage.getItem("players")||"[]");
let pairs=JSON.parse(localStorage.getItem("pairs")||"{}");

function save(){localStorage.setItem("players",JSON.stringify(players));localStorage.setItem("pairs",JSON.stringify(pairs));render();}
function addPlayer(){
 let n=playerName.value.trim();
 if(!n||players.find(p=>p.name==n))return;
 players.push({name:n,points:0,played:0,setsWin:0,setsTotal:0,gamesWin:0,gamesTotal:0,streak:0,best:0});
 playerName.value="";save();
}

function processMatch(){
 let A=[a1.value,a2.value],B=[b1.value,b2.value];
 if(new Set([...A,...B]).size<4)return alert("Jugadores invÃ¡lidos");
 let sA=0,sB=0,gA=0,gB=0;
 [[s1a,s1b],[s2a,s2b],[s3a,s3b]].forEach((s,i)=>{
 let a=parseInt(s[0].value||0),b=parseInt(s[1].value||0);
 if(i==2&&a==0&&b==0)return;
 gA+=a;gB+=b;if(a>b)sA++;else sB++;
 });
 let winA=sA>sB;
 players.forEach(p=>{
 let inA=A.includes(p.name),inB=B.includes(p.name);
 if(!inA&&!inB)return;
 p.played++;
 let win=(inA&&winA)||(inB&&!winA);
 p.points+=win?3:1;
 p.streak=win?p.streak+1:0;
 p.best=Math.max(p.best,p.streak);
 p.setsWin+=inA?sA:sB;
 p.setsTotal+=sA+sB;
 p.gamesWin+=inA?gA:gB;
 p.gamesTotal+=gA+gB;
 });
 let key=[...A].sort().join("&");pairs[key]=pairs[key]||{pj:0,pg:0};pairs[key].pj++;if(winA)pairs[key].pg++;
 key=[...B].sort().join("&");pairs[key]=pairs[key]||{pj:0,pg:0};pairs[key].pj++;if(!winA)pairs[key].pg++;
 ["s1a","s1b","s2a","s2b","s3a","s3b"].forEach(i=>document.getElementById(i).value="");save();
}

function render(){
 let pct=(w,t)=>t?((w/t)*100).toFixed(1)+"%":"0%";
 rankPoints.innerHTML=[...players].sort((a,b)=>b.points-a.points).map(p=>`<tr><td>${p.name}</td><td>${p.played}</td><td>${p.points}</td><td>ðŸ”¥${p.streak}</td></tr>`).join("");
 rankSets.innerHTML=[...players].sort((a,b)=>(b.setsWin/b.setsTotal)-(a.setsWin/a.setsTotal)).map(p=>`<tr><td>${p.name}</td><td>${p.setsWin}</td><td>${p.setsTotal}</td><td class=pct>${pct(p.setsWin,p.setsTotal)}</td></tr>`).join("");
 rankGames.innerHTML=[...players].sort((a,b)=>(b.gamesWin/b.gamesTotal)-(a.gamesWin/a.gamesTotal)).map(p=>`<tr><td>${p.name}</td><td>${p.gamesWin}</td><td>${p.gamesTotal}</td><td class=pct>${pct(p.gamesWin,p.gamesTotal)}</td><td>${(p.gamesTotal/p.played||0).toFixed(1)}</td></tr>`).join("");
 rankPairs.innerHTML=Object.entries(pairs).sort((a,b)=>(b[1].pg/b[1].pj)-(a[1].pg/a[1].pj)).map(p=>`<tr><td>${p[0]}</td><td>${p[1].pj}</td><td>${p[1].pg}</td><td class=pct>${pct(p[1].pg,p[1].pj)}</td></tr>`).join("");
 [a1,a2,b1,b2].forEach(s=>{let v=s.value;s.innerHTML='<option></option>'+players.map(p=>`<option>${p.name}</option>`).join("");s.value=v});
}
render();
</script>
</body>
</html>
